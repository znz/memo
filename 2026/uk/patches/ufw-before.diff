diff --git a/ufw/before.rules b/ufw/before.rules
index 23b384e..7490ee7 100644
--- a/ufw/before.rules
+++ b/ufw/before.rules
@@ -32,18 +32,28 @@
 
 # ok icmp codes for INPUT
 -A ufw-before-input -p icmp --icmp-type destination-unreachable -j ACCEPT
+-A ufw-before-input -p icmp --icmp-type source-quench -j ACCEPT
 -A ufw-before-input -p icmp --icmp-type time-exceeded -j ACCEPT
 -A ufw-before-input -p icmp --icmp-type parameter-problem -j ACCEPT
 -A ufw-before-input -p icmp --icmp-type echo-request -j ACCEPT
 
+# ok icmp codes for OUTPUT
+-A ufw-before-output -p icmp --icmp-type destination-unreachable -j ACCEPT
+-A ufw-before-output -p icmp --icmp-type source-quench -j ACCEPT
+-A ufw-before-output -p icmp --icmp-type time-exceeded -j ACCEPT
+-A ufw-before-output -p icmp --icmp-type parameter-problem -j ACCEPT
+-A ufw-before-output -p icmp --icmp-type echo-request -j ACCEPT
+
 # ok icmp code for FORWARD
 -A ufw-before-forward -p icmp --icmp-type destination-unreachable -j ACCEPT
+-A ufw-before-forward -p icmp --icmp-type source-quench -j ACCEPT
 -A ufw-before-forward -p icmp --icmp-type time-exceeded -j ACCEPT
 -A ufw-before-forward -p icmp --icmp-type parameter-problem -j ACCEPT
 -A ufw-before-forward -p icmp --icmp-type echo-request -j ACCEPT
 
 # allow dhcp client to work
 -A ufw-before-input -p udp --sport 67 --dport 68 -j ACCEPT
+-A ufw-before-output -p udp --dport 67 --sport 68 -j ACCEPT
 
 #
 # ufw-not-local
@@ -66,10 +76,12 @@
 # allow MULTICAST mDNS for service discovery (be sure the MULTICAST line above
 # is uncommented)
 -A ufw-before-input -p udp -d 224.0.0.251 --dport 5353 -j ACCEPT
+-A ufw-before-output -p udp -d 224.0.0.251 --dport 5353 -j ACCEPT
 
 # allow MULTICAST UPnP for service discovery (be sure the MULTICAST line above
 # is uncommented)
 -A ufw-before-input -p udp -d 239.255.255.250 --dport 1900 -j ACCEPT
+-A ufw-before-output -p udp -d 239.255.255.250 --dport 1900 -j ACCEPT
 
 # don't delete the 'COMMIT' line or these rules won't be processed
 COMMIT
diff --git a/ufw/before6.rules b/ufw/before6.rules
index abebbe7..61b1170 100644
--- a/ufw/before6.rules
+++ b/ufw/before6.rules
@@ -47,6 +47,7 @@
 # codes 0-2 (echo-reply needs to be before INVALID, see above)
 -A ufw6-before-input -p icmpv6 --icmpv6-type parameter-problem -j ACCEPT
 -A ufw6-before-input -p icmpv6 --icmpv6-type echo-request -j ACCEPT
+-A ufw6-before-input -p icmpv6 --icmpv6-type echo-reply -j ACCEPT
 -A ufw6-before-input -p icmpv6 --icmpv6-type router-solicitation -m hl --hl-eq 255 -j ACCEPT
 -A ufw6-before-input -p icmpv6 --icmpv6-type router-advertisement -m hl --hl-eq 255 -j ACCEPT
 -A ufw6-before-input -p icmpv6 --icmpv6-type neighbor-solicitation -m hl --hl-eq 255 -j ACCEPT
@@ -99,6 +100,7 @@
 -A ufw6-before-output -p icmpv6 --icmpv6-type 132 -s fe80::/10 -j ACCEPT
 # MLD report v2
 -A ufw6-before-output -p icmpv6 --icmpv6-type 143 -s fe80::/10 -j ACCEPT
+-A ufw6-before-output -p icmpv6 --icmpv6-type 143 -d ff02::16 -j ACCEPT
 # SEND certificate path solicitation
 -A ufw6-before-output -p icmpv6 --icmpv6-type 148 -m hl --hl-eq 255 -j ACCEPT
 # SEND certificate path advertisement
@@ -120,23 +122,31 @@
 -A ufw6-before-forward -p icmpv6 --icmpv6-type echo-request -j ACCEPT
 -A ufw6-before-forward -p icmpv6 --icmpv6-type echo-reply -j ACCEPT
 # ok icmp codes for FORWARD (rfc4890, 4.3.2)
-# Home Agent Address Discovery Reques
+# Home Agent Address Discovery Request
 -A ufw6-before-input -p icmpv6 --icmpv6-type 144 -j ACCEPT
+-A ufw6-before-output -p icmpv6 --icmpv6-type 144 -j ACCEPT
 # Home Agent Address Discovery Reply
 -A ufw6-before-input -p icmpv6 --icmpv6-type 145 -j ACCEPT
+-A ufw6-before-output -p icmpv6 --icmpv6-type 145 -j ACCEPT
 # Mobile Prefix Solicitation
 -A ufw6-before-input -p icmpv6 --icmpv6-type 146 -j ACCEPT
+-A ufw6-before-output -p icmpv6 --icmpv6-type 146 -j ACCEPT
 # Mobile Prefix Advertisement
 -A ufw6-before-input -p icmpv6 --icmpv6-type 147 -j ACCEPT
+-A ufw6-before-output -p icmpv6 --icmpv6-type 147 -j ACCEPT
 
 # allow dhcp client to work
 -A ufw6-before-input -p udp -s fe80::/10 --sport 547 -d fe80::/10 --dport 546 -j ACCEPT
+-A ufw6-before-output -p udp -s fe80::/10 --dport 547 -d fe80::/10 --sport 546 -j ACCEPT
+-A ufw6-before-output -p udp -s fe80::/10 --dport 547 -d ff02::1:2 --sport 546 -j ACCEPT
 
 # allow MULTICAST mDNS for service discovery
 -A ufw6-before-input -p udp -d ff02::fb --dport 5353 -j ACCEPT
+-A ufw6-before-output -p udp -d ff02::fb --dport 5353 -j ACCEPT
 
 # allow MULTICAST UPnP for service discovery
 -A ufw6-before-input -p udp -d ff02::f --dport 1900 -j ACCEPT
+-A ufw6-before-output -p udp -d ff02::f --dport 1900 -j ACCEPT
 
 # don't delete the 'COMMIT' line or these rules won't be processed
 COMMIT
